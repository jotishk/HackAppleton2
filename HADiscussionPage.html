<!DOCTYPE html>
<%
  String articleID = "895";
  String articleTitle = "";
  String author = "";
  String article = "";
  try {
    
    Class.forName("oracle.jdbc.driver.OracleDriver");
    Connection c = DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521:orcl", "system", "orcl");

    Statement stmt = c.createStatement();
    ResultSet discussions = stmt.executeQuery("select * from HADiscussions");
    while (discussions.next()) {
      if (Integer.parseInt(articleID) == discussions.getInt("DiscussionID")) {
        articleTitle = discussions.getString("DiscussionTitle");
        author = discussions.getString("DiscussionOwner");
        article = discussions.getString("DiscussionContent");
      }
    }
  } catch (Exception e) {
    System.out.println(e);
  }
  
%>
<%@ page import="java.sql.*" %>
<%@ page import="java.util.*" %>
<%@ page import="java.text.*" %>
<html>
  <head>
    <link rel = "stylesheet" href = "HADiscussionPage.css">
  </head>
  <body>
    <div class = "header">
      <p class = "logo-name">Website Name</p>
      <button class="search-button">
      <img class = "search-image" src = "595474_search_512x512.png">
      </button>
      <input class = "search-bar" placeholder="Search">  
      <div class = "profile">
        <img class = "profile-image" src = "EmptyAvatar.jpg">
        <p class = "username"></p>
      </div>
    </div> 
    <div class = "side-bar">
      <a class = "dashboard-button" href = "HAMainPage.jsp"><span class = "side-bar-text">Dashboard</span></a>
      <a class = "create-button" href = "HACreatePage.jsp"><span class = "side-bar-text">Create</span></a>
      <a class = "discussion-button" href = ""><span class = "side-bar-text">Discussion</span></a>
    </div>
    <div class = "discussion-box">
      <img class = "article-image">
      <div class = "article-details">
        <p class = "article-title"><%=articleTitle%></p>
        <div class = "author-details">
          <img class = "profilepic-image" src = "EmptyAvatar.jpg">
          <p class = "owner-username"><%=author%></p>
        </div>
        
      </div>
      <p class = "body-text"><%=article%></p>
      <div class = "comment-box">
        <p class = "comment-title"># Comments</p>
        <div class = "create-comment-box">
          <img class = "your-comment-profile-image" src = "EmptyAvatar.jpg">
          <form  class = "create-comment-form" style = "display: inline;" enctype="multipart/form-data" action = "HADiscussionPage.jsp" method = "post">
            <input class = "create-comment-input" type = "text" name = "comment-input">
          </form>
          
        </div>
        <div class = "article-comment">
          <img class = "comment-profile-image" src = "EmptyAvatar.jpg">
          <div class = "comment-content">
            <p style = "margin: 5px; font-weight: 600; font-family:'Roboto', sans-serif;">Test Username</p>
            <p style = "margin: 5px; font-family:'Roboto', sans-serif;"   class = "comment-text">Test Text</p>
          </div>
        </div>
      </div>
      
    </div>
  </body>
  <script>
    let isSignedIn = true;
    const usernameElement = document.querySelector(".username");
    let username = "TestAccount1"
    const commentInput = document.querySelector(".create-comment-input");
    let postButton = document.createElement("input");
    postButton.className = "post-button";

    commentInput.addEventListener("focus", function() {
      document.querySelector(".create-comment-form").appendChild(postButton);
    });
    commentInput.addEventListener("blur", function() {
      document.querySelector(".create-comment-form").removeChild(postButton);
    });
    if (isSignedIn) {
      usernameElement.innerText = username;
    }
  </script>
</hmtl>